<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="./../assets/css/bootstrap.min.css">
    <!--! END: Bootstrap CSS-->
    <!--! BEGIN: Vendors CSS-->
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/vendors.min.css">
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/select2.min.css">
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/select2-theme.min.css">
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/tagify.min.css">
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/tagify-data.min.css">
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/quill.min.css">
    <!--! END: Vendors CSS-->
    <!--! BEGIN: Custom CSS-->
    <link rel="stylesheet" type="text/css" href="./../assets/css/theme.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyA328xLn_K8VfCJQvYYzqFqjWY9kuhyMEo",
            authDomain: "fundsweb-c3fa2.firebaseapp.com",
            projectId: "fundsweb-c3fa2",
            storageBucket: "fundsweb-c3fa2.firebasestorage.app",
            messagingSenderId: "174402074044",
            appId: "1:174402074044:web:da77c88ab14a33c8b167b9"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const provider = new firebase.auth.GoogleAuthProvider();
    </script>

    <!--! END: Custom CSS-->
    <!--! HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries !-->
    <!--! WARNING: Respond.js doesn"t work if you view the page via file: !-->
    <!--[if lt IE 9]>
			<script src="https:oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https:oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
</head>

<body>
    <!--! ================================================================ !-->
    <!--! [Start] Main Content !-->
    <!--! ================================================================ !-->
    <main class="nxl-container apps-container apps-email bg-white">
        <div class="nxl-content without-header nxl-full-content">
            <!-- [ Main Content ] start -->
            <div class="row">
                <!-- First container (main card) -->

                <div class="d-flex justify-content-center" style="min-height:100vh;">
                    <div class="main-content" style="width: 50%;">
                        <div class="row justify-content-center">
                            <div class="col-xl-10">
                                <div class="card stretch stretch-full shadow-sm">
                                    <div class="card-body">
                                        <form id="register-form">
                                            <h4 class="mb-4" style="color:rgb(49, 215, 204);">Login</h4>

                                            <!-- Name Inputs -->
                                            <div class="row" style="margin-top: 2%;">
                                                <div class="col-md-12 mb-3">
                                                    <label class="form-label">User Name <span
                                                            class="text-danger">*</span></label>
                                                    <input type="text" id="username" class="form-control"
                                                        placeholder="Enter Username">
                                                </div>
                                                <div class="col-md-12 mb-3">
                                                    <label class="form-label">Password <span
                                                            class="text-danger">*</span></label>
                                                    <div class="input-group">
                                                        <input type="password" id="password" class="form-control"
                                                            placeholder="Enter Password">
                                                        <button class="btn btn-outline-secondary toggle-password"
                                                            type="button">
                                                            <i class="fa fa-eye"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Submit -->
                                            <div class="d-flex justify-content-center mt-3">
                                                <button type="submit" class="btn px-4"
                                                    style="background-color: #36d5d5; color: #fff;">
                                                    Login
                                                </button>
                                            </div>

                                            <div class="col-md-12 text-center mb-3 mt-3">
                                                <span style="font-weight: 600; color: #999;">OR</span>
                                            </div>

                                            <!-- Google Login -->
                                            <div class="col-md-12 mb-3">
                                                <div class="d-flex justify-content-between gap-3 flex-wrap">
                                                    <button id="google-login-btn" type="button"
                                                        class="btn btn-outline-dark w-100 d-flex align-items-center justify-content-center"
                                                        style="height: 50px;">
                                                        <img src="https://img.icons8.com/color/20/000000/google-logo.png"
                                                            class="me-2" alt="Google Icon" style="margin-right: 2%;" />
                                                        Continue with Google
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- Register Link -->
                                            <div class="col-md-12" style="margin-top: -2%;">
                                                <div class="tp-login-register text-center mt-20">
                                                    <p>Don't have an account? <a href="/register.html"
                                                            target="_top">Register here</a></p>
                                                </div>
                                            </div>


                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <style>
                    .progress-steps {
                        display: flex;
                        justify-content: space-between;
                        position: relative;
                    }

                    .progress-steps::before {
                        content: '';
                        position: absolute;
                        top: 15px;
                        left: 0;
                        right: 0;
                        height: 2px;
                        background: #ddd;
                        z-index: 1;
                    }

                    .progress-steps .step {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        position: relative;
                        z-index: 2;
                    }

                    .progress-steps .step span {
                        width: 30px;
                        height: 30px;
                        border-radius: 50%;
                        background: #ddd;
                        color: #fff;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin-bottom: 5px;
                        font-weight: bold;
                    }

                    .progress-steps .step p {
                        font-size: 12px;
                        color: #777;
                        margin: 0;
                        text-align: center;
                    }

                    .progress-steps .step.active span {
                        background: rgb(49, 215, 204);
                        ;
                    }

                    .progress-steps .step.active p {
                        color: rgb(49, 215, 204);
                        ;
                        font-weight: bold;
                    }
                </style>

                <!-- [ Content Area ] end -->
            </div>
            <!-- [ Main Content ] end -->
        </div>
    </main>
    <!--! ================================================================ !-->
    <!--! [End] Main Content !-->
    <!--! ================================================================ !-->
    <!--! ================================================================ !-->
    <!--! BEGIN: Compose Mail Modal !-->
    <!--! ================================================================ !-->
    <!--! ================================================================ !-->
    <!--! END: Compose Mail Modal !-->
    <!--! ================================================================ !-->
    <!--! ================================================================ !-->
    <!--! [Start] Search Modal !-->
    <!--! ================================================================ !-->

    <style>
        main.nxl-container.apps-container.apps-email {
            margin-top: 0 !important;
            padding-top: 0 !important;
            position: relative;
            top: 0;
        }

        main.nxl-container.apps-container.apps-email {
            margin: 0 !important;
            padding: 0 !important;
            position: relative;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            /* Full viewport height */
            box-sizing: border-box;
        }

        .content-sidebar-header .btn-primary {
            background-color: #36d5d5 !important;
            border-color: #36d5d5 !important;
            color: white !important;
        }

        .content-sidebar-header .btn-primary:hover {
            background-color: #36d5d5 !important;
            /* darker teal */
            border-color: #36d5d5 !important;
        }
    </style>

    <style>
        .email-chip {
            display: flex;
            align-items: center;
            background-color: #e0e0e0;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
            color: #333;
        }

        .email-chip .remove-btn {
            margin-left: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        .email-chip .remove-btn:hover {
            color: red;
        }

        .email-chip .avatar {
            width: 22px;
            height: 22px;
            background-color: #9cc1f9;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
    </style>

    <!--! ================================================================ !-->
    <!--! [End] Theme Customizer !-->
    <!--! ================================================================ !-->
    <!--! ================================================================ !-->
    <!--! Footer Script !-->
    <!--! ================================================================ !-->
    <!--! BEGIN: Vendors JS !-->
    <script src="./../assets/vendors/js/vendors.min.js"></script>
    <!-- vendors.min.js {always must need to be top} -->
    <script src="./../assets/vendors/js/select2.min.js"></script>
    <script src="./../assets/vendors/js/select2-active.min.js"></script>
    <script src="./../assets/vendors/js/tagify.min.js"></script>
    <script src="./../assets/vendors/js/tagify-data.min.js"></script>
    <script src="./../assets/vendors/js/quill.min.js"></script>
    <!--! END: Vendors JS !-->
    <!--! BEGIN: Apps Init  !-->
    <script src="./../assets/js/common-init.min.js"></script>
    <script src="./../assets/js/apps-email-init.min.js"></script>
    <!--! END: Apps Init !-->
    <!--! BEGIN: Theme Customizer  !-->
    <script src="./../assets/js/theme-customizer-init.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!--! END: Theme Customizer !-->

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

    <!-- Flatpickr -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Bootstrap JS (optional) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        $(document).ready(function () {
            $(document).on('click', '.toggle-password', function (e) {
                e.preventDefault();
                const $btn = $(this);
                const $input = $btn.closest('.input-group').find('input').first();
                if (!$input || $input.length === 0) return;
                const currentType = $input.attr('type');
                const newType = currentType === 'password' ? 'text' : 'password';
                $input.attr('type', newType);
                $btn.find('i').toggleClass('fa-eye fa-eye-slash');
            });

            $("#loginForm").on("submit", function (e) {
                e.preventDefault();

                const email = $("#username").val().trim();
                const password = $("#password").val().trim();

                if (!email || !password) {
                    Swal.fire({
                        icon: "warning",
                        title: "Missing Information",
                        text: "Please enter both email and password.",
                        confirmButtonColor: "#3085d6"
                    });
                    return;
                }

                Swal.fire({
                    title: "Signing in...",
                    text: "Please wait while we log you in.",
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                $.ajax({
                    url: "https://eduroom.in/api/v1/user/login",
                    method: "POST",
                    contentType: "application/json",
                    data: JSON.stringify({ email: email, password: password }),
                    success: function (res) {
                        console.log(res);
                        Swal.close();

                        Swal.fire({
                            icon: "success",
                            title: "Login Successful",
                            text: "Redirecting you to the site...",
                            timer: 2000,
                            showConfirmButton: false
                        }).then(() => {
                            window.top.location.href = "/profile.html";
                        });
                    },
                    error: function (xhr) {
                        Swal.close();

                        Swal.fire({
                            icon: "error",
                            title: "Login Failed",
                            text: "Invalid credentials, please try again.",
                            timer: 3000,
                            showConfirmButton: false
                        });
                    }
                });
            });
        });
    </script>

    <script>
        $(document).ready(function () {
            $('#google-login-btn').on('click', function () {

                console.log("Firebase:", firebase);
                console.log("auth:", firebase.auth());
                console.log("signInWithPopup:", firebase.auth().signInWithPopup);

                Swal.fire({
                    title: 'Logging in with Google...',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                auth.signInWithPopup(provider)
                    .then(result => {
                        console.log("User signed in:", result.user);
                        return result.user.getIdToken();
                    })
                    .then(idToken => {
                        console.log("Retrieved ID token:", idToken);
                        return $.ajax({
                            url: "https://eduroom.in/api/v1/user/google-login",
                            type: "POST",
                            contentType: "application/json",
                            data: JSON.stringify({ idToken: idToken }),
                        });
                    })
                    .then(response => {
                        console.log("Google login response:", response);
                        Swal.close();
                        Swal.fire({
                            icon: 'success',
                            title: 'Login Successful!',
                            showConfirmButton: false,
                            timer: 1500
                        });
                    })
                    .catch(error => {
                        Swal.close();
                        Swal.fire({
                            icon: 'error',
                            title: 'Google Login Failed',
                            text: error.message
                        });
                        console.error("Google login failed:", error);
                    });
            });
        });
    </script>

</body>

</html>