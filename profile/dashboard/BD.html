<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="keyword" content="" />
    <meta name="author" content="" />
    <!--! The above 6 meta tags *must* come first in the head; any other head content must come *after* these tags !-->
    <!--! BEGIN: Apps Title-->
    <title>Eduroom || Dashboard</title>
    <!--! END:  Apps Title-->
    <!--! BEGIN: Favicon-->
    <link rel="shortcut icon" type="image/x-icon" href="/assets/images/FundsAuditLogo.png" />
    <!--! END: Favicon-->
    <!--! BEGIN: Bootstrap CSS-->
    <link rel="stylesheet" type="text/css" href="./../assets/css/bootstrap.min.css" />
    <!--! END: Bootstrap CSS-->
    <!--! BEGIN: Vendors CSS-->
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/vendors.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/tagify.min.css">
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/tagify-data.min.css">
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/quill.min.css">
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/select2.min.css">
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/select2-theme.min.css">
    <link rel="stylesheet" type="text/css" href="./../assets/vendors/css/daterangepicker.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <!--! END: Vendors CSS-->
    <!--! BEGIN: Custom CSS-->
    <link rel="stylesheet" type="text/css" href="./../assets/css/theme.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>


    <script>
        function setStickyColumns() {
            const table = document.getElementById("leadsTable");
            if (!table) return;

            const stickyCols = 3;
            let leftOffsets = [];

            let total = 0;
            const firstRow = table.querySelector("thead tr:first-child");
            for (let i = 0; i < stickyCols; i++) {
                const th = firstRow.querySelector(`th:nth-child(${i + 1})`);
                if (th) {
                    leftOffsets[i] = total;
                    total += th.offsetWidth;
                }
            }

            requestAnimationFrame(() => {
                const headerRows = table.querySelectorAll("thead tr");
                let cumulativeTop = 0;

                headerRows.forEach(row => {
                    const rowHeight = row.offsetHeight;

                    row.querySelectorAll("th").forEach(th => {
                        th.style.position = "sticky";
                        th.style.top = cumulativeTop + "px";
                        th.style.background = "#fff";
                        th.style.zIndex = 12;
                    });

                    for (let i = 0; i < stickyCols; i++) {
                        const th = row.querySelector(`th:nth-child(${i + 1})`);
                        if (th) {
                            th.style.left = leftOffsets[i] + "px";
                            th.style.zIndex = 16;
                        }
                    }

                    cumulativeTop += rowHeight;
                });

                const rows = table.querySelectorAll("tbody tr");
                rows.forEach(row => {
                    for (let i = 0; i < stickyCols; i++) {
                        const td = row.querySelector(`td:nth-child(${i + 1})`);
                        if (td) {
                            td.style.position = "sticky";
                            td.style.left = leftOffsets[i] + "px";
                            td.style.background = "#fff";
                            td.style.zIndex = 6;
                        }
                    }
                });
            });
        }

        window.addEventListener("load", setStickyColumns);
        window.addEventListener("resize", setStickyColumns);
    </script>

    <script>
        function setStickyColumns2() {
            const table = document.getElementById("leadsTable2");
            if (!table) return;

            const stickyCols = 4;
            let leftOffsets = [];

            let total = 0;
            const firstRow = table.querySelector("thead tr:first-child");
            for (let i = 0; i < stickyCols; i++) {
                const th = firstRow.querySelector(`th:nth-child(${i + 1})`);
                if (th) {
                    leftOffsets[i] = total;
                    total += th.offsetWidth;
                }
            }

            requestAnimationFrame(() => {
                const headerRows = table.querySelectorAll("thead tr");
                let cumulativeTop = 0;

                headerRows.forEach(row => {
                    const rowHeight = row.offsetHeight;

                    row.querySelectorAll("th").forEach(th => {
                        th.style.position = "sticky";
                        th.style.top = cumulativeTop + "px";
                        th.style.background = "#fff";
                        th.style.zIndex = 12;
                    });

                    for (let i = 0; i < stickyCols; i++) {
                        const th = row.querySelector(`th:nth-child(${i + 1})`);
                        if (th) {
                            th.style.left = leftOffsets[i] + "px";
                            th.style.zIndex = 16;
                        }
                    }

                    cumulativeTop += rowHeight;
                });

                const rows = table.querySelectorAll("tbody tr");
                rows.forEach(row => {
                    for (let i = 0; i < stickyCols; i++) {
                        const td = row.querySelector(`td:nth-child(${i + 1})`);
                        if (td) {
                            td.style.position = "sticky";
                            td.style.left = leftOffsets[i] + "px";
                            td.style.background = "#fff";
                            td.style.zIndex = 6;
                        }
                    }
                });
            });
        }

        window.addEventListener("load", setStickyColumns2);
        window.addEventListener("resize", setStickyColumns2);
    </script>

    <script>
        function setStickyColumns3() {
            const table = document.getElementById("leadsTable3");
            if (!table) return;

            const stickyCols = 4; // number of columns to keep sticky
            let leftOffsets = [];

            let total = 0;
            const firstRow = table.querySelector("thead tr:first-child");
            for (let i = 0; i < stickyCols; i++) {
                const th = firstRow.querySelector(`th:nth-child(${i + 1})`);
                if (th) {
                    leftOffsets[i] = total;
                    total += th.offsetWidth;
                }
            }

            requestAnimationFrame(() => {
                const headerRows = table.querySelectorAll("thead tr");
                let cumulativeTop = 0;

                headerRows.forEach(row => {
                    const rowHeight = row.offsetHeight;

                    row.querySelectorAll("th").forEach(th => {
                        th.style.position = "sticky";
                        th.style.top = cumulativeTop + "px";
                        th.style.background = "#fff";
                        th.style.zIndex = 12;
                    });

                    for (let i = 0; i < stickyCols; i++) {
                        const th = row.querySelector(`th:nth-child(${i + 1})`);
                        if (th) {
                            th.style.left = leftOffsets[i] + "px";
                            th.style.zIndex = 16;
                        }
                    }

                    cumulativeTop += rowHeight;
                });

                const rows = table.querySelectorAll("tbody tr");
                rows.forEach(row => {
                    for (let i = 0; i < stickyCols; i++) {
                        const td = row.querySelector(`td:nth-child(${i + 1})`);
                        if (td) {
                            td.style.position = "sticky";
                            td.style.left = leftOffsets[i] + "px";
                            td.style.background = "#fff";
                            td.style.zIndex = 6;
                        }
                    }
                });
            });
        }

        window.addEventListener("load", setStickyColumns3);
        window.addEventListener("resize", setStickyColumns3);
    </script>
    <!--! END: Custom CSS-->
    <!--! HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries !-->
    <!--! WARNING: Respond.js doesn"t work if you view the page via file: !-->
    <!--[if lt IE 9]>
			<script src="https:oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https:oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
</head>

<body>
    <!--! ================================================================ !-->
    <!--! [Start] Navigation Manu !-->
    <!--! ================================================================ !-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <nav class="nxl-navigation">
        <div class="navbar-wrapper">
            <div class="m-header">
                <a href="#" class="b-brand">
                    <img src="/images/favicon.svg" alt="" class="logo logo-lg" />
                    <img src="/images/favicon.svg" alt="" class="logo logo-sm" />
                </a>
            </div>

            <div class="navbar-content">
                <ul class="nxl-navbar">
                    <li class="nxl-item nxl-caption">
                        <label>Navigation</label>
                    </li>

                    <!-- PASSWORD PROTECTED DROPDOWN -->
                    <li class="nxl-item nxl-hasmenu" id="protectedDropdown">
                        <a href="javascript:void(0);" class="nxl-link protected-menu-trigger" id="protectedTrigger">
                            <span class="nxl-micon"><i class="feather-upload"></i></span>
                            <span class="nxl-mtext">ADD COURSE DETAILS</span>
                            <span class="nxl-arrow"><i class="feather-chevron-right"></i></span>
                        </a>

                        <!-- hidden by default -->
                        <ul class="nxl-submenu protected-submenu" style="display: none;">
                            <li class="nxl-item"><a class="nxl-link"
                                    href="/profile/dashboard/add-selection-domain.html">ADD SELECTION DOMAIN</a></li>
                            <li class="nxl-item"><a class="nxl-link"
                                    href="/profile/dashboard/update-selection-domain.html">UPDATE SELECTION DOMAIN</a>
                            </li>
                            <li class="nxl-item"><a class="nxl-link"
                                    href="/profile/dashboard/add-selection-questions.html">ADD SELECTION QUESTIONS</a>
                            </li>
                            <li class="nxl-item"><a class="nxl-link"
                                    href="/profile/dashboard/update-selection-questions.html">UPDATE SELECTION
                                    QUESTIONS</a></li>
                            <li class="nxl-item"><a class="nxl-link" href="/profile/dashboard/index.html">ADD DOMAIN</a>
                            </li>
                            <li class="nxl-item"><a class="nxl-link" href="/profile/dashboard/add-course.html">ADD
                                    COURSE</a></li>
                            <li class="nxl-item"><a class="nxl-link"
                                    href="/profile/dashboard/add-course-preview.html">ADD COURSE PREVIEW</a></li>
                            <li class="nxl-item"><a class="nxl-link"
                                    href="/profile/dashboard/add-course-details.html">ADD COURSE DETAILS</a></li>
                            <li class="nxl-item"><a class="nxl-link" href="/profile/dashboard/update-domain.html">UPDATE
                                    DOMAIN</a></li>
                            <li class="nxl-item"><a class="nxl-link" href="/profile/dashboard/update-course.html">UPDATE
                                    COURSE</a></li>
                            <li class="nxl-item"><a class="nxl-link"
                                    href="/profile/dashboard/update-course-preview.html">UPDATE COURSE PREVIEW</a></li>
                            <li class="nxl-item"><a class="nxl-link"
                                    href="/profile/dashboard/update-course-details.html">UPDATE COURSE DETAILS</a></li>
                        </ul>
                    </li>

                    <!-- OTHER MENU ITEMS UNCHANGED -->
                    <li class="nxl-item nxl-hasmenu">
                        <a href="javascript:void(0);" class="nxl-link">
                            <span class="nxl-micon"><i class="feather-airplay"></i></span>
                            <span class="nxl-mtext">TEAM MANAGER</span>
                            <span class="nxl-arrow"><i class="feather-chevron-right"></i></span>
                        </a>

                        <ul class="nxl-submenu">
                            <li class="nxl-item"><a class="nxl-link" href="/profile/dashboard/targets.html">MY
                                    TARGETS</a></li>
                            <li class="nxl-item"><a class="nxl-link" href="/profile/dashboard/CO.html">CO SHEET</a></li>
                            <li class="nxl-item"><a class="nxl-link" href="/profile/dashboard/RE.html">RE SHEET</a></li>
                            <!-- <li class="nxl-item"><a class="nxl-link" href="/profile/dashboard/R.html">R SHEET</a></li> -->
                            <li class="nxl-item"><a class="nxl-link"
                                    href="/profile/dashboard/team-manager.html">REGISTRATION SHEET</a></li>
                        </ul>
                    </li>

                    <li class="nxl-item">
                        <a href="javascript:void(0);" id="logoutBtn" class="nxl-link">
                            <span class="nxl-micon"><i class="feather-settings"></i></span>
                            <span class="nxl-mtext">Logout</span>
                            <span class="nxl-arrow"><i class="feather-chevron-right"></i></span>
                        </a>
                    </li>
                </ul>
                <div class="card text-center">
                    <div class="card-body">
                        <i class="feather-briefcase fs-4 text-dark"></i>
                        <h6 class="mt-4 text-dark fw-bolder">Welcome to FundsRoom</h6>
                        <p class="fs-11 my-3 text-dark">
                            FundsRoom is your trusted financial partner, offering seamless solutions for managing
                            investments, loans, and business funds with ease.
                        </p>
                        <!-- <a href="https://www.fundsroom.com/" class="btn btn-primary text-dark w-100" style="margin-bottom: 10%;">Fundsroom</a>
                        <a href="https://play.google.com/store/apps/details?id=com.fundsroom.fundsaudit&hl=en_IN" class="btn btn-success text-light w-100">Download FundsAudit</a> -->
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!--! ================================================================ !-->
    <!--! [End]  Navigation Manu !-->
    <!--! ================================================================ !-->
    <!--! ================================================================ !-->
    <!--! [Start] Header !-->
    <!--! ================================================================ !-->
    <header class="nxl-header">
        <div class="header-wrapper">
            <!--! [Start] Header Left !-->
            <div class="header-left d-flex align-items-center gap-4">
                <!--! [Start] nxl-head-mobile-toggler !-->
                <a href="javascript:void(0);" class="nxl-head-mobile-toggler" id="mobile-collapse">
                    <div class="hamburger hamburger--arrowturn">
                        <div class="hamburger-box">
                            <div class="hamburger-inner"></div>
                        </div>
                    </div>
                </a>
                <!--! [Start] nxl-head-mobile-toggler !-->
                <!--! [Start] nxl-navigation-toggle !-->
                <div class="nxl-navigation-toggle">
                    <a href="javascript:void(0);" id="menu-mini-button">
                        <i class="feather-align-left"></i>
                    </a>
                    <a href="javascript:void(0);" id="menu-expend-button" style="display: none">
                        <i class="feather-arrow-right"></i>
                    </a>
                </div>
                <!--! [End] nxl-navigation-toggle !-->
                <!--! [Start] nxl-lavel-mega-menu-toggle !-->
                <!-- <div class="nxl-lavel-mega-menu-toggle d-flex d-lg-none">
                    <a href="javascript:void(0);" id="nxl-lavel-mega-menu-open">
                        <i class="feather-align-left"></i>
                    </a>
                </div> -->
                <!--! [End] nxl-lavel-mega-menu-toggle !-->
                <!--! [Start] nxl-lavel-mega-menu !-->
                <div class="nxl-drp-link nxl-lavel-mega-menu">
                    <div class="nxl-lavel-mega-menu-toggle d-flex d-lg-none">
                        <a href="javascript:void(0)" id="nxl-lavel-mega-menu-hide">
                            <i class="feather-arrow-left me-2"></i>
                            <span>Back</span>
                        </a>
                    </div>

                    <!--! [End] nxl-lavel-mega-menu-wrapper !-->
                </div>
                <!--! [End] nxl-lavel-mega-menu !-->
            </div>
            <!--! [End] Header Left !-->
            <!--! [Start] Header Right !-->
            <div class="header-right ms-auto">
                <div class="d-flex align-items-center">

                    <!-- Full Screen Switcher -->
                    <!-- <div class="nxl-h-item d-none d-sm-flex">
                        <div class="full-screen-switcher">
                            <a href="javascript:void(0);" class="nxl-head-link me-0"
                                onclick="$('body').fullScreenHelper('toggle');">
                                <i class="feather-maximize maximize"></i>
                                <i class="feather-minimize minimize"></i>
                            </a>
                        </div>
                    </div> -->

                    <!-- User Dropdown -->
                    <div class="dropdown nxl-h-item">
                        <a href="javascript:void(0);" data-bs-toggle="dropdown" role="button"
                            data-bs-auto-close="outside">
                            <div class="avatar-text avatar-lg bg-gray-200">
                                <i class="feather-user"></i>
                            </div>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end nxl-h-dropdown nxl-user-dropdown">
                            <div class="dropdown-header">
                                <section id="user-header">
                                    <div id="user-section" class="user-dropdown">
                                        <a>
                                            <i class="feather-user"></i>
                                            <span id="manager-name">User</span></a>
                                    </div>
                                    <script>
                                        const managerName5 = sessionStorage.getItem("userName");
                                        const nameElement = document.getElementById("manager-name");
                                        if (nameElement && managerName5 && managerName5.trim() !== "") {
                                            nameElement.textContent = managerName5;
                                        }
                                    </script>
                                </section>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--! [End] Header Right !-->
        </div>
    </header>
    <!--! ================================================================ !-->
    <!--! [End] Header !-->
    <!--! ================================================================ !-->
    <!--! ================================================================ !-->
    <!--! [Start] Main Content !-->
    <!--! ================================================================ !-->
    <main class="nxl-container">
        <div class="nxl-content">
            <!-- [ page-header ] start -->
            <div class="page-header">
                <div class="page-header-left d-flex align-items-center">
                    <!-- <div class="page-header-title">
                        <h5 class="m-b-10">Dashboard</h5>
                    </div> -->
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a href="CO.html">Home</a></li>
                        <li class="breadcrumb-item">BD Dashboard</li>
                    </ul>
                </div>
                <div class="page-header-right ms-auto">
                    <div class="page-header-right-items">
                        <div class="d-flex d-md-none">
                            <a href="javascript:void(0)" class="page-header-right-close-toggle">
                                <i class="feather-arrow-left me-2"></i>
                                <span>Back</span>
                            </a>
                        </div>
                    </div>
                    <!-- <div class="d-md-none d-flex align-items-center">
                        <a href="javascript:void(0)" class="page-header-right-open-toggle">
                            <i class="feather-align-right fs-20"></i>
                        </a>
                    </div> -->
                </div>
                <!-- <div class="position-relative border-bottom">
                    <label for="excelUpload" class="dropdown-item upload-trigger" style="cursor:pointer;">
                        <span class="btn btn-icon" data-bs-toggle="tooltip" data-bs-trigger="hover"
                            title="Upload Excel files (Less than 5MB)">
                            <i class="feather-upload"></i> Upload College Data
                        </span>
                    </label>
                    <input type="file" id="excelUpload" accept=".csv,.xls,.xlsx" style="display:none;">

                </div> -->
                <div class="date-picker-container" style="margin-left: 1%;">
                    <input type="text" id="dateRangePicker" class="form-control" placeholder="Select date or range"
                        style="max-width:220px;" />
                </div>
            </div>
            <!-- [ page-header ] end -->
            <!-- [ Main Content ] start -->
            <div class="main-content">
                <div class="row">
                    <!-- college count -->
                    <div class="col-xxl-4 col-lg-2 col-md-4">
                        <div class="card stretch stretch-full">
                            <div class="card-body">
                                <div class="fs-12 fw-medium text-muted mb-3">Interns allotted</div>
                                <div class="d-flex flex-column align-items-start lh-base">
                                    <h3><span id="totalColleges">0</span>/<span id="targetColleges">0</span></h3>
                                    <span id="collegesPercent" class="fs-11 text-muted">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Resume Count -->
                    <div class="col-xxl-4 col-lg-2 col-md-4">
                        <div class="card stretch stretch-full">
                            <div class="card-body">
                                <div class="fs-12 fw-medium text-muted mb-3">Interns active</div>
                                <div class="d-flex flex-column align-items-start lh-base">
                                    <h3><span id="totalResumes">0</span>/<span id="targetResumes">0</span></h3>
                                    <span id="resumesPercent" class="fs-11 text-muted">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Accounts -->
                    <div class="col-xxl-4 col-lg-2 col-md-4">
                        <div class="card stretch stretch-full">
                            <div class="card-body">
                                <div class="fs-12 fw-medium text-muted mb-3">Accounts</div>
                                <div class="d-flex flex-column align-items-start lh-base">
                                    <h3><span id="totalInterviews">0</span>/<span id="targetInterviews">0</span></h3>
                                    <span id="interviewsPercent" class="fs-11 text-muted">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Interviews scheduled -->
                <!-- <div class="col-xxl-4 col-lg-2 col-md-6">
                        <div class="card stretch stretch-full">
                            <div class="card-body">
                                <div class="fs-12 fw-medium text-muted mb-3">Interviews scheduled</div>
                                <div class="d-flex flex-column align-items-start lh-base">
                                    <h3><span id="totalInterviews">0</span>/<span id="targetInterviews">0</span></h3>
                                    <span id="interviewsPercent" class="fs-11 text-muted">0%</span>
                                </div>
                            </div>
                        </div>
                    </div> -->

                <!-- <div class="col-xxl-12 col-lg-12 col-md-12 d-flex justify-content-center align-items-center">
                    <div class="card stretch stretch-full" id="remainingCallsCard"
                        style="width: 100%; max-width: 1400px;">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center fs-18 fw-medium mb-3">
                                <div>
                                    Remaining Follow Ups: <span id="remainingCalls" style="color:white;">0</span>
                                </div>
                                <div>
                                    Achieved Percentage: <span id="achievementPercent2">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> -->
                <!-- <div class="row">
                    <div class="col-12">
                        <div class="card stretch stretch-full">
                            <div class="card-header">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="card-title" id="reSheetTitle">
                                        INDIVIDUAL R SHEET (Total count: <span id="collegeCount2">0</span>)
                                    </h5>
                                </div>
                                <div class="card-header-action">
                                    <div class="search-wrapper" id="searchWrapper2">
                                        <button id="searchToggle2" class="search-icon">
                                            <img src="https://cdn-icons-png.flaticon.com/512/622/622669.png"
                                                alt="Search" width="20" height="20">
                                        </button>
                                        <div class="search-bar" id="searchBar2">
                                            <input type="text" id="searchInput2" class="form-control"
                                                placeholder="Search..." oninput="filterTable2()">
                                        </div>
                                    </div>

                                    <div data-bs-toggle="tooltip" title="Maximize/Minimize">
                                        <a href="javascript:void(0);" class="avatar-xs" data-bs-toggle="expand">
                                            <i class="feather-maximize maximize" style="font-size: 15px;"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>

                            <div class="card-body custom-card-action p-0">
                                <div class="table-responsive">
                                    <table class="table table-bordered table-hover mb-0" id="leadsTable2">
                                        <thead class="table-light">
                                            <tr class="border-b">
                                                <th>Delete</th>
                                                <th>SR</th>
                                                <th>NAME OF STUDENT</th>
                                                <th>Resgitration Status</th>
                                                <th>Date of Registartion</th>
                                                <th>Time of Registartion</th>
                                                <th>DATE OF RESUMES RECEIVED</th>
                                                <th>COLLEGE NAME</th>
                                                <th>COURSE</th>
                                                <th>INTERNSHIP TYPE</th>
                                                <th>COLLEGE ONBOARDED BY</th>
                                                <th>MOBILE NUMBER</th>
                                                <th>EMAIL ID</th>
                                                <th>DOMAIN</th>
                                                <th>Knowledge Score</th>
                                                <th>Approach Score</th>
                                                <th>Skills Score</th>
                                                <th>Other Score</th>
                                                <th>Total average score</th>
                                                <th>Selection status</th>
                                                <th>Comment</th>
                                                <th>Date of interview</th>
                                                <th>Call Status</th>
                                                <th>Alloted to</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="card-footer">
                                <div class="d-flex justify-content-between align-items-center">
                                    <ul class="list-unstyled d-flex align-items-center gap-2 mb-0 pagination-common-style"
                                        id="pagination2">
                                    </ul>
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-primary" onclick="printTable2()">
                                            <i class="bi bi-printer"></i> Print
                                        </button>
                                        <button class="btn btn-success" onclick="exportToExcel2()">
                                            <i class="bi bi-file-earmark-excel"></i> Excel
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <script>
                    const userData5 = JSON.parse(sessionStorage.getItem("user_data"));
                    if (userData5 && userData5.name) {
                        document.getElementById("reSheetTitle").innerHTML =
                            `${userData5.name}'s RESUME Sheet (Total count: <span id="collegeCount2">0</span>)`;
                    }
                </script> -->

                <style>
                    #dateRangePicker2::placeholder {
                        font-weight: 700;
                        color: #000;
                        opacity: 1;
                    }

                    .search-wrapper {
                        position: relative;
                        display: flex;
                        align-items: center;
                    }

                    .search-icon {
                        background: none;
                        border: none;
                        cursor: pointer;
                        margin-right: 8px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        padding: 4px;
                    }

                    .search-bar {
                        display: none;
                    }

                    .search-bar.active {
                        display: block;
                    }

                    #searchInput2 {
                        padding: 6px 10px;
                        border: 1px solid #ccc;
                        border-radius: 6px;
                    }
                </style>

                <script>
                    const searchToggle2 = document.getElementById("searchToggle2");
                    const searchBar2 = document.getElementById("searchBar2");
                    const searchWrapper2 = document.getElementById("searchWrapper2");

                    searchToggle2.addEventListener("click", () => {
                        const isActive = searchBar2.classList.toggle("active");

                        if (isActive) {
                            document.getElementById("searchInput2").focus();
                            if (typeof loadTableData2 === "function") loadTableData2();
                        }
                    });

                    document.addEventListener("click", (event) => {
                        if (!searchWrapper2.contains(event.target)) {
                            searchBar2.classList.remove("active");
                        }
                    });
                </script>


                <div class="col-xxl-12">
                    <div class="card stretch stretch-full overflow-hidden">
                        <div class="bg-success text-white">
                            <div class="p-4 d-flex justify-content-between align-items-center">
                                <h5 class="card-title" id="reSheetTitle3">
                                    RESUME ANALYTICS
                                </h5>
                            </div>
                            <div id="conversion-statistic-bar-chart"></div>
                        </div>
                        <div class="card-body">
                            <h6 class="mb-3">Resumes sent</h6>
                            <ul class="list-group" id="jdList">
                                <!-- Dates and JD counts will be appended here -->
                            </ul>
                        </div>
                    </div>
                </div>

                <script>
                    const userData7 = JSON.parse(sessionStorage.getItem("user_data"));
                    if (userData7 && userData7.name) {
                        document.getElementById("reSheetTitle3").innerHTML =
                            `(${userData7.name}'s ANALYTICS)`;
                    }
                </script>

                <hr style="border: none; border-top: 10px dotted #000000; margin-top: 10px;">

                <div class="row">

                    <div class="col-12">
                        <div class="card stretch stretch-full">
                            <div class="card-header">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="card-title">BD SHEET of <span id="manager-name2">User</span>
                                        (Total count: <span id="collegeCount">0</span>)</h5>
                                </div>
                                <div class="card-header-action">
                                    <!-- <div data-bs-toggle="tooltip" title="Refresh">
                                        <a href="javascript:void(0);" class="avatar-text avatar-xs bg-warning"
                                            onclick="loadTableData()"> </a>
                                    </div> -->
                                    <div class="search-wrapper" id="searchWrapper">
                                        <button id="searchToggle" class="search-icon">
                                            <img src="https://cdn-icons-png.flaticon.com/512/622/622669.png"
                                                alt="Search" width="20" height="20">
                                        </button>
                                        <div class="search-bar" id="searchBar">
                                            <input type="text" id="searchInput" class="form-control"
                                                placeholder="Search..." oninput="filterTable()">
                                        </div>
                                    </div>

                                    <div data-bs-toggle="tooltip" title="Maximize/Minimize">
                                        <a href="javascript:void(0);" class="avatar-xs" data-bs-toggle="expand">
                                            <i class="feather-maximize maximize" style="font-size: 15px;"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>

                            <div class="card-body custom-card-action p-0">
                                <div class="table-responsive">
                                    <table class="table table-bordered table-hover mb-0" id="leadsTable">
                                        <thead class="table-light">
                                            <tr class="border-b">
                                                <!-- <th>Delete</th> -->
                                                <th>SR</th>
                                                <th>NAME OF STUDENT</th>
                                                <th>MOBILE NUMBER</th>
                                                <th>EMAIL ID</th>
                                                <th>BUSINESS TASKS</th>
                                                <th>CATEGORY</th>
                                                <th>DOMAIN</th>
                                                <th>Start Date</th>
                                                <th>End Date</th>
                                                <th>Connect Date</th>
                                                <th>Call Status</th>
                                                <th>Registration Status</th>
                                                <th>Selection Test</th>
                                                <th>WhatsApp Group</th>
                                                <th>Day 1 Attendance</th>
                                                <th>Day 1 Date </th>
                                                <th>Day 1 Domain Task</th>
                                                <th>Day 2 Attendance</th>
                                                <th>Day 2 Date </th>
                                                <th>Day 2 Domain Task</th>
                                                <th>Day 3 Attendance</th>
                                                <th>Day 3 Date </th>
                                                <th>Day 3 Domain Task</th>
                                                <th>Day 4 Attendance</th>
                                                <th>Day 4 Date </th>
                                                <th>Day 4 Domain Task</th>
                                                <th>Day 5 Attendance</th>
                                                <th>Day 5 Date </th>
                                                <th>Day 5 Domain Task</th>
                                                <th>Day 6 Attendance</th>
                                                <th>Day 6 Date </th>
                                                <th>Day 6 Domain Task</th>
                                                <th>Day 7 Attendance</th>
                                                <th>Day 7 Date </th>
                                                <th>Day 7 Domain Task</th>
                                                <th>Module 2 Status</th>
                                                <th>TL Allocated</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Rows dynamically injected here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="card-footer">
                                <div class="d-flex justify-content-between align-items-center">
                                    <ul class="list-unstyled d-flex align-items-center gap-2 mb-0 pagination-common-style"
                                        id="pagination">
                                        <!-- Pagination links will be dynamically populated here -->
                                    </ul>
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-primary" onclick="printTable()">
                                            <i class="bi bi-printer"></i> Print
                                        </button>
                                        <button class="btn btn-success" onclick="exportToExcel()">
                                            <i class="bi bi-file-earmark-excel"></i> Excel
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <style>
                        #dateRangePicker2::placeholder {
                            font-weight: 700;
                            color: #000;
                            opacity: 1;
                        }

                        .search-wrapper {
                            position: relative;
                            display: flex;
                            align-items: center;
                        }

                        .search-icon {
                            background: none;
                            border: none;
                            cursor: pointer;
                            margin-right: 8px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            padding: 4px;
                        }

                        .search-bar {
                            display: none;
                        }

                        .search-bar.active {
                            display: block;
                        }

                        #searchInput {
                            padding: 6px 10px;
                            border: 1px solid #ccc;
                            border-radius: 6px;
                        }
                    </style>

                    <script>
                        const searchToggle = document.getElementById("searchToggle");
                        const searchBar = document.getElementById("searchBar");
                        const searchWrapper = document.getElementById("searchWrapper");

                        searchToggle.addEventListener("click", () => {
                            const isActive = searchBar.classList.toggle("active");

                            if (isActive) {
                                document.getElementById("searchInput").focus();

                                loadTableData();
                                loadTableData2();
                            }
                        });

                        document.addEventListener("click", (event) => {
                            if (!searchWrapper.contains(event.target)) {
                                searchBar.classList.remove("active");
                            }
                        });
                    </script>

                    <style>
                        .table-responsive {
                            overflow-x: auto;
                            position: relative;
                        }

                        #leadsTable {
                            border-collapse: collapse;
                            width: max-content;
                            font-family: 'Inter', sans-serif;
                            font-size: 14px;
                            background: #fff;
                            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
                            border-radius: 8px;
                        }

                        .column-filter {
                            display: inline-block !important;
                            width: 100%;
                            margin-top: 4px;
                        }


                        #leadsTable th {
                            font-weight: 600;
                            text-align: left;
                            padding: 8px 12px;
                            border-bottom: 2px solid #e5e7eb;
                            position: sticky;
                            top: 0;
                            z-index: 10;
                        }

                        #leadsTable th:nth-child(-n+3) {
                            background: #fff;
                            color: #000;
                            z-index: 15;
                        }

                        #leadsTable th:nth-child(n+4) {
                            background: #fff;
                            color: #000;
                            font-weight: bold;
                            font-size: 13px;
                        }

                        #leadsTable td {
                            vertical-align: middle;
                            padding: 8px 12px;
                            white-space: nowrap;
                            border-bottom: 1px solid #f1f5f9;
                        }

                        /* #leadsTable tr:nth-child(even) td {
                            background: #fafafa;
                        } */

                        #leadsTable tr:hover td {
                            background: #f1f5ff;
                        }

                        #leadsTable th:nth-child(-n+3),
                        #leadsTable td:nth-child(-n+3) {
                            position: sticky;
                            left: 0;
                            z-index: 5;
                            border-right: 1px solid #dee2e6;
                            background: #fff;
                            font-size: 13px;
                        }

                        #leadsTable input,
                        #leadsTable select {
                            display: none;
                            width: 100%;
                            font-size: 14px;
                            padding: 6px 8px;
                            border: 1px solid #cbd5e1;
                            border-radius: 6px;
                            background: #fff;
                        }

                        #leadsTable td.editing input,
                        #leadsTable td.editing select {
                            display: block;
                        }

                        #leadsTable td span {
                            display: inline-block;
                            width: 100%;
                            min-height: 22px;
                            font-size: 14px;
                            cursor: pointer;
                            color: #1e293b;
                        }

                        #leadsTable td.editing {
                            background: #ffffff;
                            box-shadow: inset 0 0 0 2px #fff;
                        }

                        /* Columns 7 to 13  Soft Amber */
                        #leadsTable th:nth-child(8),
                        #leadsTable th:nth-child(9),
                        #leadsTable th:nth-child(10),
                        #leadsTable th:nth-child(11),
                        #leadsTable th:nth-child(12),
                        #leadsTable th:nth-child(13),
                        #leadsTable th:nth-child(14) {
                            background-color: #f3e8ff !important;
                            /* Light Purple */
                            color: #4b1d79;
                        }

                        #leadsTable th:nth-child(15),
                        #leadsTable th:nth-child(16),
                        #leadsTable th:nth-child(17) {
                            background-color: #fff8e1 !important;
                            /* Soft Amber */
                            color: #b36b00;
                        }

                        /* Columns 16 & 17  Teal tone */
                        #leadsTable th:nth-child(18),
                        #leadsTable th:nth-child(19),
                        #leadsTable th:nth-child(20) {
                            background-color: #e0fffa !important;
                            /* Light Teal */
                            color: #0b4f47;
                        }

                        /* Columns 18 & 19  Gray tone */
                        #leadsTable th:nth-child(21),
                        #leadsTable th:nth-child(22),
                        #leadsTable th:nth-child(23) {
                            background-color: #d6d8dc !important;
                            /* Soft Gray */
                            color: #374151;
                        }

                        #leadsTable th:nth-child(24),
                        #leadsTable th:nth-child(25),
                        #leadsTable th:nth-child(26) {
                            background-color: #fff0e1 !important;
                            /* Orange */
                            color: #7c2d12;
                        }

                        #leadsTable th:nth-child(27),
                        #leadsTable th:nth-child(28),
                        #leadsTable th:nth-child(29) {
                            background-color: #e0f2ff !important;
                            /* Blue */
                            color: #0c4a6e;
                        }

                        #leadsTable th:nth-child(30),
                        #leadsTable th:nth-child(31),
                        #leadsTable th:nth-child(32) {
                            background-color: #dbffdd !important;
                            /* Yellow */
                            color: #127128;
                        }

                        /* Optional: for C1 section */
                        #leadsTable th:nth-child(33),
                        #leadsTable th:nth-child(34),
                        #leadsTable th:nth-child(35) {
                            background-color: #ffe5e5 !important;
                            /* Red */
                            color: #7f1d1d;
                        }
                    </style>

                    <style>
                        .table-responsive {
                            overflow-x: auto;
                            position: relative;
                        }

                        #leadsTable2 {
                            border-collapse: collapse;
                            width: max-content;
                            font-family: 'Inter', sans-serif;
                            font-size: 14px;
                            background: #fff;
                            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
                            border-radius: 8px;
                        }

                        .column-filter2 {
                            display: inline-block !important;
                            width: 100%;
                            margin-top: 4px;
                        }

                        #leadsTable2 th {
                            font-weight: 600;
                            text-align: left;
                            padding: 8px 12px;
                            border-bottom: 2px solid #e5e7eb;
                            position: sticky;
                            top: 0;
                            z-index: 10;
                        }

                        #leadsTable2 th:nth-child(-n+3) {
                            background: #fff;
                            color: #000;
                            z-index: 15;
                        }

                        #leadsTable2 th:nth-child(n+4) {
                            background: #fff;
                            color: #000;
                            font-weight: bold;
                            font-size: 13px;
                        }

                        #leadsTable2 td {
                            vertical-align: middle;
                            padding: 8px 12px;
                            white-space: nowrap;
                            border-bottom: 1px solid #f1f5f9;
                        }

                        #leadsTable2 tr:nth-child(even) td {
                            background: #fafafa;
                        }

                        #leadsTable2 tr:hover td {
                            background: #f1f5ff;
                        }

                        #leadsTable2 th:nth-child(-n+3),
                        #leadsTable2 td:nth-child(-n+3) {
                            position: sticky;
                            left: 0;
                            z-index: 5;
                            border-right: 1px solid #dee2e6;
                            background: #fff;
                            font-size: 13px;
                        }

                        #leadsTable2 input,
                        #leadsTable2 select {
                            display: none;
                            width: 100%;
                            font-size: 14px;
                            padding: 6px 8px;
                            border: 1px solid #cbd5e1;
                            border-radius: 6px;
                            background: #fff;
                        }

                        #leadsTable2 td.editing input,
                        #leadsTable2 td.editing select {
                            display: block;
                        }

                        #leadsTable2 td span {
                            display: inline-block;
                            width: 100%;
                            min-height: 22px;
                            font-size: 14px;
                            cursor: pointer;
                            color: #1e293b;
                        }

                        #leadsTable2 td.editing {
                            background: #ffffff;
                            box-shadow: inset 0 0 0 2px #fff;
                        }
                    </style>

                    <!-- Calendar Component -->
                    <!-- <div class="col-4 flex-fill calendar-container">
                        <div class="card stretch stretch-full">
                            <div class="card-body">
                                <div class="calendar">
                                    <div class="calendar-header">
                                        <button id="prevMonth">&lt;</button>
                                        <h2 id="currentMonthYear">March 2025</h2>
                                        <button id="nextMonth">&gt;</button>
                                    </div>
                                    <div class="calendar-grid">
                                        <div class="calendar-weekdays">
                                            <div>MON</div>
                                            <div>TUE</div>
                                            <div>WED</div>
                                            <div>THU</div>
                                            <div>FRI</div>
                                            <div>SAT</div>
                                            <div>SUN</div>
                                        </div>
                                        <div class="calendar-days" id="calendarDays"></div>
                                    </div>
                                </div>
                                <div id="errorMessage" class="text-danger mt-2" style="display: none;">
                                    Failed to fetch data. Please try again.
                                </div>
                                <div class="selected-range mt-3">
                                    <strong>Selected:</strong>
                                    <span id="selectedRange"></span>
                                </div>
                            </div>
                        </div>
                    </div> -->
                    <!-- [Project Calendar] end -->

                </div>
                <hr style="border: none; border-top: 10px dotted #000000; margin-top: 10px;">

                <div class="row" style="margin-bottom: 3%;">

                    <!-- <div class="date-picker-container d-flex justify-content-center"
                            style="margin-top: 0%; margin-bottom: 0%; margin-right:2%;">
                            <input type="text" id="dateRangePicker2" class="form-control text-center fw-bold"
                                placeholder="Select date or range"
                                style="max-width:220px; font-weight:700; color:#000; opacity:1;" />
                        </div> -->

                    <style>
                        #dateRangePicker2::placeholder {
                            font-weight: 700;
                            color: #000;
                            opacity: 1;
                        }
                    </style>
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="card-title" id="reSheetTitle2">
                            CATEGORICAL ANALYTICS
                        </h5>
                    </div>

                    <div class="row g-3">
                        <!-- Not Working -->
                        <div class="col-md-3">
                            <a href="/profile/dashboard/bd-tables/bd-category-table.html?category=not working" class="text-decoration-none">
                                <div class="card bg-danger text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="m-0">Not Working:</p>
                                                <h4 style="color: white;">0</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>

                        <!-- Starter -->
                        <div class="col-md-3">
                            <a href="/profile/dashboard/bd-tables/bd-category-table.html?category=Starter" class="text-decoration-none">
                                <div class="card bg-danger text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="m-0">Starter:</p>
                                                <h4 style="color: white;">0</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>

                        <!-- Basic -->
                        <div class="col-md-3">
                            <a href="/profile/dashboard/bd-tables/bd-category-table.html?category=Basic" class="text-decoration-none">
                                <div class="card bg-warning text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="m-0">Basic:</p>
                                                <h4 style="color: white;">0</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>

                        <!-- Bronze -->
                        <div class="col-md-3">
                            <a href="/profile/dashboard/bd-tables/bd-category-table.html?category=Bronze" class="text-decoration-none">
                                <div class="card bg-warning text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="m-0">Bronze:</p>
                                                <h4 style="color: white;">0</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>

                        <!-- Silver -->
                        <div class="col-md-3">
                            <a href="/profile/dashboard/bd-tables/bd-category-table.html?category=Silver" class="text-decoration-none">
                                <div class="card bg-blue text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="m-0">Silver:</p>
                                                <h4 style="color: white;">0</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>

                        <!-- Gold -->
                        <div class="col-md-3">
                            <a href="/profile/dashboard/bd-tables/bd-category-table.html?category=Gold" class="text-decoration-none">
                                <div class="card bg-blue text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="m-0">Gold:</p>
                                                <h4 style="color: white;">0</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>

                        <!-- Platinum -->
                        <div class="col-md-3">
                            <a href="/profile/dashboard/bd-tables/bd-category-table.html?category=Platinum" class="text-decoration-none">
                                <div class="card bg-success text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="m-0">Platinum:</p>
                                                <h4 style="color: white;">0</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>

                        <!-- Diamond -->
                        <div class="col-md-3">
                            <a href="/profile/dashboard/bd-tables/bd-category-table.html?category=Diamond" class="text-decoration-none">
                                <div class="card bg-success text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="m-0">Diamond:</p>
                                                <h4 style="color: white;">0</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>

                    <script>
                        const userData6 = JSON.parse(sessionStorage.getItem("user_data"));
                        if (userData6 && userData6.name) {
                            document.getElementById("reSheetTitle2").innerHTML =
                                `${userData6.name}'s ANALYTICS`;
                        }
                    </script>

                </div>
                <!-- <hr style="border: none; border-top: 10px dotted #000000; margin-top: 10px;"> -->

                <!-- <div class="col-12 flex-fill">
                    <div class="card stretch stretch-full">

                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="card-title">FUTURE DETAILS(Total Count: <span id="collegeCount3">0</span>)
                                </h5>
                            </div>

                            <div class="card-header-action d-flex align-items-center gap-2">

                                <div class="search-wrapper3" id="searchWrapper3">
                                    <button id="searchToggle3" class="search-icon">
                                        <img src="https://cdn-icons-png.flaticon.com/512/622/622669.png" alt="Search"
                                            width="20" height="20">
                                    </button>
                                    <div class="search-bar3" id="searchBar3">
                                        <input type="text" id="searchInput3" class="form-control"
                                            placeholder="Search..." oninput="filterTable3()">
                                    </div>
                                </div>

                                <div data-bs-toggle="tooltip" title="Maximize/Minimize">
                                    <a href="javascript:void(0);" class="avatar-xs" data-bs-toggle="expand">
                                        <i class="feather-maximize maximize" style="font-size: 15px;"></i>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div class="card-body custom-card-action p-0">
                            <div class="table-responsive">
                                <table class="table table-hover mb-0" id="leadsTable3">
                                    <thead>
                                        <tr class="border-b">
                                            <th>Delete</th>
                                            <th>SR</th>
                                            <th>NAME OF STUDENT</th>
                                            <th>Resgitration Status</th>
                                            <th>Date of Registartion</th>
                                            <th>Time of Registartion</th>
                                            <th>DATE OF RESUMES RECEIVED</th>
                                            <th>COLLEGE NAME</th>
                                            <th>COURSE</th>
                                            <th>INTERNSHIP TYPE</th>
                                            <th>COLLEGE ONBOARDED BY</th>
                                            <th>MOBILE NUMBER</th>
                                            <th>EMAIL ID</th>
                                            <th>DOMAIN</th>
                                            <th>Knowledge Score</th>
                                            <th>Approach Score</th>
                                            <th>Skills Score</th>
                                            <th>Other Score</th>
                                            <th>Total average score</th>
                                            <th>Selection status</th>
                                            <th>Comment</th>
                                            <th>Date of interview</th>
                                            <th>Call Status</th>
                                            <th>Alloted to</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>

                        <div class="card-footer">
                            <div class="d-flex justify-content-between align-items-center">
                                <ul class="list-unstyled d-flex align-items-center gap-2 mb-0 pagination-common-style"
                                    id="pagination3"></ul>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-primary" onclick="printTable3()">
                                        <i class="bi bi-printer"></i> Print
                                    </button>
                                    <button class="btn btn-success" onclick="exportToExcel3()">
                                        <i class="bi bi-file-earmark-excel"></i> Excel
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> -->

                <style>
                    #dateRangePicker2::placeholder {
                        font-weight: 700;
                        color: #000;
                        opacity: 1;
                    }

                    .search-wrapper3 {
                        position: relative;
                        display: flex;
                        align-items: center;
                    }

                    .search-icon {
                        background: none;
                        border: none;
                        cursor: pointer;
                        margin-right: 8px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        padding: 4px;
                    }

                    .search-bar3 {
                        display: none;
                    }

                    .search-bar3.active {
                        display: block;
                    }

                    #searchInput3 {
                        padding: 6px 10px;
                        border: 1px solid #ccc;
                        border-radius: 6px;
                    }
                </style>

                <script>
                    const searchToggle3 = document.getElementById("searchToggle3");
                    const searchBar3 = document.getElementById("searchBar3");
                    const searchWrapper3 = document.getElementById("searchWrapper3");

                    searchToggle3.addEventListener("click", () => {
                        const isActive = searchBar3.classList.toggle("active");

                        if (isActive) {
                            document.getElementById("searchInput3").focus();

                            loadTableData3();
                        }
                    });

                    document.addEventListener("click", (event) => {
                        if (!searchWrapper3.contains(event.target)) {
                            searchBar3.classList.remove("active");
                        }
                    });
                </script>

                <style>
                    .table-responsive {
                        overflow-x: auto;
                        position: relative;
                    }

                    #leadsTable3 {
                        border-collapse: collapse;
                        width: max-content;
                        font-family: 'Inter', sans-serif;
                        font-size: 14px;
                        background: #fff;
                        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
                        border-radius: 8px;
                    }

                    .column-filter3 {
                        display: inline-block !important;
                        width: 100%;
                        margin-top: 4px;
                    }

                    #leadsTable3 th {
                        font-weight: 600;
                        text-align: left;
                        padding: 8px 12px;
                        border-bottom: 2px solid #e5e7eb;
                        position: sticky;
                        top: 0;
                        z-index: 10;
                    }

                    #leadsTable3 th:nth-child(-n+3) {
                        background: #fff;
                        color: #000;
                        z-index: 15;
                    }

                    #leadsTable3 th:nth-child(n+4) {
                        background: #fff;
                        color: #000;
                        font-weight: bold;
                        font-size: 13px;
                    }

                    #leadsTable3 td {
                        vertical-align: middle;
                        padding: 8px 12px;
                        white-space: nowrap;
                        border-bottom: 1px solid #f1f5f9;
                    }

                    #leadsTable3 tr:nth-child(even) td {
                        background: #fafafa;
                    }

                    #leadsTable3 tr:hover td {
                        background: #f1f5ff;
                    }

                    #leadsTable3 th:nth-child(-n+3),
                    #leadsTable3 td:nth-child(-n+3) {
                        position: sticky;
                        left: 0;
                        z-index: 5;
                        border-right: 1px solid #dee2e6;
                        background: #fff;
                        font-size: 13px;
                    }

                    #leadsTable3 input,
                    #leadsTable3 select {
                        display: none;
                        width: 100%;
                        font-size: 14px;
                        padding: 6px 8px;
                        border: 1px solid #cbd5e1;
                        border-radius: 6px;
                        background: #fff;
                    }

                    #leadsTable3 td.editing input,
                    #leadsTable3 td.editing select {
                        display: block;
                    }

                    #leadsTable3 td span {
                        display: inline-block;
                        width: 100%;
                        min-height: 22px;
                        font-size: 14px;
                        cursor: pointer;
                        color: #1e293b;
                    }

                    #leadsTable3 td.editing {
                        background: #ffffff;
                        box-shadow: inset 0 0 0 2px #fff;
                    }
                </style>


                <style>
                    .card-header-action {
                        gap: 10px;
                    }

                    .month-dropdown select {
                        min-width: 160px;
                        border-radius: 8px;
                        border: 1px solid #ddd;
                        background-color: #f8f9fa;
                        padding: 4px 8px;
                        font-size: 14px;
                        transition: all 0.2s ease-in-out;
                    }

                    .month-dropdown select:hover {
                        border-color: #0d6efd;
                        background-color: #fff;
                        box-shadow: 0 0 6px rgba(13, 110, 253, 0.2);
                    }

                    .search-bar .input-group {
                        border: 1px solid #ddd;
                        border-radius: 8px;
                        overflow: hidden;
                        transition: box-shadow 0.2s;
                    }

                    .search-bar .input-group:focus-within {
                        box-shadow: 0 0 6px rgba(13, 110, 253, 0.2);
                        border-color: #0d6efd;
                    }

                    .search-bar input {
                        border: none;
                        outline: none;
                        font-size: 14px;
                    }
                </style>


                <!-- [ Main Content ] end -->
            </div>
            <!-- [ Footer ] start -->
            <footer class="footer">
                <p class="fs-11 text-muted fw-medium text-uppercase mb-0 copyright">
                    <span>Copyright Fundsroom </span>
                    <script>
                        document.write(new Date().getFullYear());
                    </script>
                </p>
                <div class="d-flex align-items-center gap-4">
                    <!-- <a href="javascript:void(0);" class="fs-11 fw-semibold text-uppercase">Help</a>
					<a href="javascript:void(0);" class="fs-11 fw-semibold text-uppercase">Terms</a>
					<a href="javascript:void(0);" class="fs-11 fw-semibold text-uppercase">Privacy</a> -->
                </div>
            </footer>
            <style>
                .flatpickr-calendar,
                .flatpickr-calendar * {
                    font-family: 'Inter', sans-serif !important;
                    font-size: 14px;
                }

                .flatpickr-months .flatpickr-month {
                    font-weight: 600;
                    color: #155fcf;
                }

                .flatpickr-weekday {
                    color: #1e293b;
                    font-weight: 500;
                }

                .flatpickr-day.selected,
                .flatpickr-day.startRange,
                .flatpickr-day.endRange {
                    background: #155fcf !important;
                    color: #fff !important;
                    border-radius: 6px;
                }

                .flatpickr-day.inRange {
                    background: #e0ebff;
                    color: #155fcf;
                }

                .flatpickr-day.today {
                    border: 1px solid #155fcf;
                }

                #dateRangePicker {
                    font-family: 'Inter', sans-serif;
                    font-size: 14px;
                    border-radius: 6px;
                    border: 1px solid #cbd5e1;
                    padding: 6px 10px;
                    color: #1e293b;
                }
            </style>
            <!-- [ Footer ] end -->
    </main>
    <!--! ================================================================ !-->
    <!--! [End] Main Content !-->
    <!--! ================================================================ !-->

    <!--! ================================================================ !-->
    <!--! Footer Script !-->
    <!--! ================================================================ !-->
    <!--! BEGIN: Vendors JS !-->
    <script src="./../assets/vendors/js/vendors.min.js"></script>
    <!-- vendors.min.js {always must need to be top} -->
    <script src="./../assets/vendors/js/daterangepicker.min.js"></script>
    <script src="./../assets/vendors/js/apexcharts.min.js"></script>
    <script src="./../assets/vendors/js/circle-progress.min.js"></script>
    <script src="./../assets/vendors/js/jquery.calendar.min.js"></script>
    <script src="./../assets/vendors/js/select2.min.js"></script>
    <script src="./../assets/vendors/js/select2-active.min.js"></script>
    <script src="./../assets/js/common-init.min.js"></script>
    <script src="./../assets/vendors/js/lslstrength.min.js"></script>
    <!--! END: Vendors JS !-->
    <!--! BEGIN: Apps Init  !-->
    <script src="./../assets/js/reports-project-init.min.js"></script>
    <script src="./../assets/js/widgets-charts-init.min.js"></script>
    <script src="./../assets/js/widgets-miscellaneous-init.min.js"></script>
    <!--! END: Apps Init !-->
    <!--! BEGIN: Theme Customizer  !-->
    <script src="./../assets/js/theme-customizer-init.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <!-- <script>
        $(document).ready(function () {
            $("#excelUpload").on("change", function (e) {
                Swal.fire({
                    title: "Uploading...",
                    text: "Please wait while we process your file.",
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                let file = e.target.files[0];
                if (!file) return;

                let reader = new FileReader();
                reader.onload = function (e) {
                    let data = new Uint8Array(e.target.result);
                    let workbook = XLSX.read(data, { type: "array" });

                    let sheetName = workbook.SheetNames[0];
                    let sheet = workbook.Sheets[sheetName];

                    let rawData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
                    console.log("Raw Excel Data:", rawData);

                    let rows = rawData.slice(2);

                    const teamManagerId = sessionStorage.getItem("user_id");
                    const managerName = sessionStorage.getItem("userName");
                    console.log("managerName:", managerName);
                    console.log(teamManagerId);

                    function parseExcelDate(value) {
                        if (!value) return null;
                        if (typeof value === "number") {
                            let jsDate = XLSX.SSF.parse_date_code(value);
                            if (jsDate) {
                                return `${jsDate.d} ${new Date(jsDate.y, jsDate.m - 1, jsDate.d)
                                    .toLocaleString("en-US", { month: "long" })} ${jsDate.y}`;
                            }
                        }
                        return value;
                    }

                    let jsonData = rows.map((row, i) => {
                        return {
                            sr: row[0] ?? i + 1,
                            resumeDate: parseExcelDate(row[1]) ?? null,
                            collegeName: row[2] ?? null,
                            course: row[3] ? row[3].toLowerCase() : null,
                            internshipType: row[4] ? row[4].toLowerCase() : null,
                            followupBy: row[5] ?? null,
                            studentName: row[6] ?? null,
                            mobileNumber: row[7] ?? null,
                            emailId: row[8] ?? null,
                            domain: row[9] ?? null,
                            interviewDate: parseExcelDate(row[10]) ?? null,
                            dateOfOnboarding: null,
                            teamManagerId: teamManagerId
                        };
                    });

                    console.log("Formatted JSON:", jsonData);

                    $.ajax({
                        url: "https://eduroom.in/api/v1/studentresume/create",
                        type: "POST",
                        contentType: "application/json",
                        data: JSON.stringify(jsonData),
                        success: function (res) {
                            console.log("Response:", res);

                            let message = "Resume data uploaded successfully.";
                            Swal.fire({
                                icon: "success",
                                title: "Upload Complete",
                                html: `${message}`,
                                confirmButtonText: "Okay"
                            });
                        },

                        error: function (xhr) {
                            console.log("Error:", xhr);
                            Swal.fire({
                                icon: "error",
                                title: "Upload Failed",
                                text: xhr.responseText || "Something went wrong!",
                            });
                        },
                    });
                };
                reader.readAsArrayBuffer(file);
            });
        });
    </script> -->
    <script>
        const managerName6 = sessionStorage.getItem("userName");
        const nameElement2 = document.getElementById("manager-name2");
        if (nameElement2 && managerName6 && managerName6.trim() !== "") {
            nameElement2.textContent = managerName6;
        }
    </script>

    <script>
        const teamManagerId = sessionStorage.getItem("user_id");
        const managerName = sessionStorage.getItem("userName");
        console.log("managerName:", managerName);
        console.log(teamManagerId);

        const apiBase = "https://eduroom.in/api/v1/bdsheet";

        const dropdowns = {
            callStatus: ["Connected", "Not Answered", "Busy", "Not Interested"],
            whatsappGroup: ["Joined", "Not Joined"],
            sessionAttendance: ["Active", "Inactive", "Not Attended", "Left", "Terminated"],
            domainTask: ["Completed", "In Progress", "Not Started", "Pending"],
            module2Status: ["Promoted", "Not Promoted", "On Hold"]
        };

        const categoryColors = {
            "not working": "#FF6666", // Red
            "Starter": "#FF9933", // Red-Orange
            "Basic": "#FFB733", // Orange
            "Bronze": "#FFD633", // Amber
            "Silver": "#FFFF66", // Yellow
            "Gold": "#D9FF66", // Yellow-Green
            "Diamond": "#99FF66", // Light Green
            "Platinum": "#66FF66" // Green
        };

        let tableData = [];
        let filteredData = [];
        let managers = [];
        const rowsPerPage = 10;
        let currentPage = 1;

        function loadTableData() {
            $.ajax({
                url: `https://eduroom.in/api/v1/bdsheet/bdsheet?managerId=${teamManagerId}`,
                method: "GET",
                success: function (res) {
                    console.log("student resumes:", res);
                    if (res.managers) {
                        managers = res.managers;
                    }

                    if (res.success && res.data) {
                        tableData = res.data.map((row, index) => {
                            const bdSheet = row.BdSheets && row.BdSheets.length > 0 ? row.BdSheets[0] : {};

                            const day1 = bdSheet.day1 || {};
                            const day2 = bdSheet.day2 || {};
                            const day3 = bdSheet.day3 || {};
                            const day4 = bdSheet.day4 || {};
                            const day5 = bdSheet.day5 || {};
                            const day6 = bdSheet.day6 || {};
                            const day7 = bdSheet.day7 || {};

                            return {
                                sno: index + 1,
                                id: row.id,
                                studentName: row.studentName || "",
                                mobileNumber: row.mobileNumber || "",
                                emailId: row.emailId || "",
                                businessTask: bdSheet.businessTask || "",
                                category: bdSheet.category || "",
                                domain: row.domain || "",

                                startDate: bdSheet.startDate || "",
                                endDate: bdSheet.endDate || "",
                                connectDate: bdSheet.connectDate || "",
                                callStatus: bdSheet.callStatus || "",
                                registration: bdSheet.registration || "",
                                selectionTest: bdSheet.selectionTest || "",
                                whatsappGroup: bdSheet.whatsappGroup || "",
                                // Day 1
                                day1Date: day1.date || "",
                                day1SessionAttendance: day1.sessionAttendance || "",
                                day1DomainTask: day1.domainTask || "",
                                // Day 2
                                day2Date: day2.date || "",
                                day2SessionAttendance: day2.sessionAttendance || "",
                                day2DomainTask: day2.domainTask || "",
                                // Day 3
                                day3Date: day3.date || "",
                                day3SessionAttendance: day3.sessionAttendance || "",
                                day3DomainTask: day3.domainTask || "",
                                // Day 4
                                day4Date: day4.date || "",
                                day4SessionAttendance: day4.sessionAttendance || "",
                                day4DomainTask: day4.domainTask || "",
                                // Day 5
                                day5Date: day5.date || "",
                                day5SessionAttendance: day5.sessionAttendance || "",
                                day5DomainTask: day5.domainTask || "",
                                // Day 6
                                day6Date: day6.date || "",
                                day6SessionAttendance: day6.sessionAttendance || "",
                                day6DomainTask: day6.domainTask || "",
                                // Day 7
                                day7Date: day7.date || "",
                                day7SessionAttendance: day7.sessionAttendance || "",
                                day7DomainTask: day7.domainTask || "",

                                module2Status: bdSheet.module2Status || "",
                                tlAllocated: bdSheet.tlAllocated || "",

                                bdSheetId: bdSheet.id
                            };
                        });

                        $("#collegeCount").text(tableData.length);
                        filteredData = [...tableData];
                        renderTable();
                        renderPagination();
                        renderColumnFilters();
                    }
                }
            });
        }

        function formatDate(dateStr) {
            if (!dateStr) return "";
            let date = new Date(dateStr);
            if (isNaN(date)) return dateStr;
            return date.toLocaleDateString("en-GB", {
                day: "numeric",
                month: "long",
                year: "numeric"
            });
        }

        function getRowColor(category) {
            return categoryColors[category] || "#FFFFFF";
        }

        function renderTable() {
            let tbody = $("#leadsTable tbody");
            tbody.empty();

            const start = (currentPage - 1) * rowsPerPage;
            const end = start + rowsPerPage;
            const rows = filteredData.slice(start, end);

            rows.forEach((row) => {
                const category = row.category || "";
                const rowColor = getRowColor(category);

                let tr = `<tr data-id="${row.id}" data-bdsheet-id="${row.bdSheetId || ''}" style="background-color: ${rowColor};">
                <td>${row.sno}</td>
                <td>${row.studentName || ""}</td>
                <td>${row.mobileNumber || ""}</td>
                <td>${row.emailId || ""}</td>
                <td>${row.businessTask || ""}</td>
                <td>${row.category ? row.category.charAt(0).toUpperCase() + row.category.slice(1) : ""}</td>
                <td>${row.domain || ""}</td>
                ${makeDateCell("startDate", row.startDate || "")}
                ${makeDateCell("endDate", row.endDate || "")}
                ${makeDateCell("connectDate", row.connectDate || "")}
                ${makeDropdownCell("callStatus", row.callStatus || "", null, dropdowns.callStatus)}
                ${makeReadonlyCell("registration", (row.registration || "").charAt(0).toUpperCase() + (row.registration || "").slice(1).toLowerCase())}
                ${makeReadonlyCell("selectionTest", row.selectionTest || "")}
                ${makeDropdownCell("whatsappGroup", row.whatsappGroup || "", null, dropdowns.whatsappGroup)}
                ${makeDropdownCell("day1SessionAttendance", row.day1SessionAttendance || "", null, dropdowns.sessionAttendance)}
                ${makeDateCell("day1Date", row.day1Date || "")}
                ${makeDropdownCell("day1DomainTask", row.day1DomainTask || "", null, dropdowns.domainTask)}
                ${makeDropdownCell("day2SessionAttendance", row.day2SessionAttendance || "", null, dropdowns.sessionAttendance)}
                ${makeDateCell("day2Date", row.day2Date || "")}
                ${makeDropdownCell("day2DomainTask", row.day2DomainTask || "", null, dropdowns.domainTask)}
                ${makeDropdownCell("day3SessionAttendance", row.day3SessionAttendance || "", null, dropdowns.sessionAttendance)}
                ${makeDateCell("day3Date", row.day3Date || "")}
                ${makeDropdownCell("day3DomainTask", row.day3DomainTask || "", null, dropdowns.domainTask)}
                ${makeDropdownCell("day4SessionAttendance", row.day4SessionAttendance || "", null, dropdowns.sessionAttendance)}
                ${makeDateCell("day4Date", row.day4Date || "")}
                ${makeDropdownCell("day4DomainTask", row.day4DomainTask || "", null, dropdowns.domainTask)}
                ${makeDropdownCell("day5SessionAttendance", row.day5SessionAttendance || "", null, dropdowns.sessionAttendance)}
                ${makeDateCell("day5Date", row.day5Date || "")}
                ${makeDropdownCell("day5DomainTask", row.day5DomainTask || "", null, dropdowns.domainTask)}
                ${makeDropdownCell("day6SessionAttendance", row.day6SessionAttendance || "", null, dropdowns.sessionAttendance)}
                ${makeDateCell("day6Date", row.day6Date || "")}
                ${makeDropdownCell("day6DomainTask", row.day6DomainTask || "", null, dropdowns.domainTask)}
                ${makeDropdownCell("day7SessionAttendance", row.day7SessionAttendance || "", null, dropdowns.sessionAttendance)}
                ${makeDateCell("day7Date", row.day7Date || "")}
                ${makeDropdownCell("day7DomainTask", row.day7DomainTask || "", null, dropdowns.domainTask)}
                ${makeDropdownCell("module2Status", row.module2Status || "", null, dropdowns.module2Status)}
                ${makeDropdownCell("tlAllocated", row.tlAllocated || "", null, managers.map(m => m.name))}
            </tr>`;
                tbody.append(tr);
            });

            attachCellEvents();
            setStickyColumns();
        }

        const columnKeys = [
            "sno",
            "studentName",
            "mobileNumber",
            "emailId",
            "businessTask",
            "category",
            "domain",
            "startDate",
            "endDate",
            "connectDate",
            "callStatus",
            "registration",
            "selectionTest",
            "whatsappGroup",
            "day1SessionAttendance",
            "day1Date",
            "day1DomainTask",
            "day2SessionAttendance",
            "day2Date",
            "day2DomainTask",
            "day3SessionAttendance",
            "day3Date",
            "day3DomainTask",
            "day4SessionAttendance",
            "day4Date",
            "day4DomainTask",
            "day5SessionAttendance",
            "day5Date",
            "day5DomainTask",
            "day6SessionAttendance",
            "day6Date",
            "day6DomainTask",
            "day7SessionAttendance",
            "day7Date",
            "day7DomainTask",
            "module2Status",
            "tlAllocated"
        ];

        function renderPagination() {
            const totalPages = Math.ceil(filteredData.length / rowsPerPage);
            const pagination = $("#pagination");
            pagination.empty();

            const visiblePageCount = 3;
            let startPage = Math.max(currentPage - 1, 1);
            let endPage = startPage + visiblePageCount - 1;
            if (endPage > totalPages) {
                endPage = totalPages;
                startPage = Math.max(endPage - visiblePageCount + 1, 1);
            }

            const prevDisabled = currentPage === 1 ? 'disabled' : '';
            const nextDisabled = currentPage === totalPages ? 'disabled' : '';

            pagination.append(`<li><a href="javascript:void(0);" class="${prevDisabled}" onclick="changePage(${currentPage - 1})">&laquo;</a></li>`);

            for (let i = startPage; i <= endPage; i++) {
                const active = i === currentPage ? "active" : "";
                pagination.append(`<li><a href="javascript:void(0);" class="${active}" onclick="changePage(${i})">${i}</a></li>`);
            }

            pagination.append(`<li><a href="javascript:void(0);" class="${nextDisabled}" onclick="changePage(${currentPage + 1})">&raquo;</a></li>`);
        }

        window.changePage = function (page) {
            const totalPages = Math.ceil(filteredData.length / rowsPerPage);
            if (page < 1 || page > totalPages) return;
            currentPage = page;
            renderTable();
            renderPagination();
        };

        function renderColumnFilters() {
            const headerRow = $("#leadsTable thead tr.filters");
            headerRow.remove();

            let filterRow = "<tr class='filters'>";
            columnKeys.forEach((key, i) => {
                if (key === "actions" || key === "sno") {
                    filterRow += "<th></th>";
                } else {
                    filterRow += `<th>
                    <select class="column-filter form-select form-select-sm" data-field="${key}">
                        <option value="">All</option>
                    </select>
                </th>`;
                }
            });
            filterRow += "</tr>";
            $("#leadsTable thead").append(filterRow);

            populateColumnFilterOptions();

            $(".column-filter").off("change").on("change", function () {
                applyFilters();
            });
        }

        function populateColumnFilterOptions() {
            $("#leadsTable thead .column-filter").each(function () {
                const field = $(this).data("field");
                let values = [];

                if (field.toLowerCase().includes("date")) {
                    values = [...new Set(
                        tableData
                            .map(row => formatDate(row[field]))
                            .filter(v => v && v.trim() !== "")
                    )];
                } else {
                    values = [...new Set(
                        tableData
                            .map(row => row[field])
                            .filter(v => v !== null && v !== undefined && v !== "")
                    )];
                }

                $(this).empty().append(`<option value="">All</option>`);
                values.forEach(v => {
                    $(this).append(`<option value="${v}">${v}</option>`);
                });
            });
        }

        function applyFilters() {
            filteredData = [...tableData];

            $("#leadsTable thead .column-filter").each(function () {
                const value = $(this).val();
                const field = $(this).data("field");

                if (value) {
                    filteredData = filteredData.filter(row => {
                        let cellValue = "";

                        if (field.toLowerCase().includes("date")) {
                            cellValue = formatDate(row[field] || "");
                        } else {
                            cellValue = row[field] || "";
                        }

                        return String(cellValue).toLowerCase() === String(value).toLowerCase();
                    });
                }
            });

            currentPage = 1;
            renderTable();
            renderPagination();
        }

        function makeCell(field, value) {
            let displayValue = value || "";
            const safeVal = String(displayValue).replace(/"/g, "&quot;");
            return `<td data-field="${field}">
            <span>${displayValue}</span>
            <input type="text" value="${safeVal}">
        </td>`;
        }

        function makeReadonlyCell(field, value) {
            let displayValue = value || "";
            return `<td data-field="${field}">
            <span>${displayValue}</span>
        </td>`;
        }

        function makeDateCell(field, value) {
            let displayValue = formatDate(value);
            let rawValue = value ? new Date(value).toISOString().split("T")[0] : "";
            return `<td data-field="${field}">
            <span>${displayValue}</span>
            <input type="text" class="date-picker" value="${rawValue}">
        </td>`;
        }

        function makeDropdownCell(field, selectedValue, stateFilter = null, optionsList = null) {
            let options = optionsList || dropdowns[field] || [];

            const formatLabel = (val) => {
                if (!val) return "";
                return String(val).charAt(0).toUpperCase() + String(val).slice(1);
            };

            let displaySelected = formatLabel(selectedValue);

            let html = `<td data-field="${field}">
            <span style="font-weight:bold;">${displaySelected}</span>
            <select class="form-control select2">`;

            html += `<option value="" ${!selectedValue ? "selected" : ""}></option>`;
            options.forEach(opt => {
                let sel = (String(opt).toLowerCase() === String(selectedValue || "").toLowerCase()) ? "selected" : "";
                html += `<option value="${opt}" ${sel}>${formatLabel(opt)}</option>`;
            });

            html += `</select></td>`;
            return html;
        }

        function attachCellEvents() {
            $("#leadsTable td").off("dblclick").on("dblclick", function () {
                let td = $(this);

                if (td.find("input").length === 0 && td.find("select").length === 0) return;
                td.addClass("editing");
                td.find("input,select").focus();
            });

            $("#leadsTable td input, #leadsTable td select")
                .off("blur change")
                .on("blur change", function (ev) {
                    if ($(this).hasClass("date-picker")) return;

                    let td = $(this).closest("td");
                    let tr = $(this).closest("tr");
                    let id = tr.data("id");
                    let bdSheetId = tr.data("bdsheet-id");
                    let field = td.data("field");
                    let value = $(this).val();

                    td.find("span").text(value);
                    td.removeClass("editing");

                    updateBdSheetRecord(id, bdSheetId, field, value);
                });

            $(".date-picker").each(function () {
                const input = $(this);
                input.flatpickr({
                    dateFormat: "Y-m-d",
                    onChange: function (selectedDates, dateStr) {
                        if (!dateStr) return;

                        let td = input.closest("td");
                        let tr = input.closest("tr");
                        let id = tr.data("id");
                        let bdSheetId = tr.data("bdsheet-id");
                        let field = td.data("field");
                        let value = new Date(dateStr).toISOString().split("T")[0];

                        td.find("span").text(formatDate(value));
                        td.removeClass("editing");

                        updateBdSheetRecord(id, bdSheetId, field, value);
                    }
                });
            });

            $("#leadsTable td select.select2").each(function () {
                if ($(this).select2) {
                    $(this).select2({ width: '100%' });
                }
            });
        }

        function updateBdSheetRecord(studentResumeId, bdSheetId, field, value) {
            let payload = {
                studentResumeId: studentResumeId
            };

            if (['startDate', 'endDate', 'connectDate', 'callStatus', 'registration',
                'selectionTest', 'whatsappGroup', 'module2Status', 'tlAllocated'].includes(field)) {
                payload[field] = value;
            }

            else if (field.startsWith('day1')) {
                const dayField = field.replace('day1', '').charAt(0).toLowerCase() + field.replace('day1', '').slice(1);
                payload.day1 = payload.day1 || {};
                payload.day1[dayField] = value;
            }

            else if (field.startsWith('day2')) {
                const dayField = field.replace('day2', '').charAt(0).toLowerCase() + field.replace('day2', '').slice(1);
                payload.day2 = payload.day2 || {};
                payload.day2[dayField] = value;
            }

            else if (field.startsWith('day3')) {
                const dayField = field.replace('day3', '').charAt(0).toLowerCase() + field.replace('day3', '').slice(1);
                payload.day3 = payload.day3 || {};
                payload.day3[dayField] = value;
            }

            else if (field.startsWith('day4')) {
                const dayField = field.replace('day4', '').charAt(0).toLowerCase() + field.replace('day4', '').slice(1);
                payload.day4 = payload.day4 || {};
                payload.day4[dayField] = value;
            }

            else if (field.startsWith('day5')) {
                const dayField = field.replace('day5', '').charAt(0).toLowerCase() + field.replace('day5', '').slice(1);
                payload.day5 = payload.day5 || {};
                payload.day5[dayField] = value;
            }

            else if (field.startsWith('day6')) {
                const dayField = field.replace('day6', '').charAt(0).toLowerCase() + field.replace('day6', '').slice(1);
                payload.day6 = payload.day6 || {};
                payload.day6[dayField] = value;
            }

            else if (field.startsWith('day7')) {
                const dayField = field.replace('day7', '').charAt(0).toLowerCase() + field.replace('day7', '').slice(1);
                payload.day7 = payload.day7 || {};
                payload.day7[dayField] = value;
            }

            if (teamManagerId) {
                payload["teamManagerId"] = teamManagerId;
            }

            console.log("UPSERT payload:", payload);

            $.ajax({
                url: `${apiBase}/upsert`,
                method: "POST",
                contentType: "application/json",
                data: JSON.stringify(payload),
                success: function (res) {
                    console.log("UPSERT success:", res);

                    if (!bdSheetId && res.data && res.data.id) {
                        loadTableData();
                    }
                },
                error: function (err) {
                    console.error("UPSERT failed", err);
                    alert("Failed to update record. Please try again.");
                }
            });
        }

        window.filterTable = function () {
            const value = $("#searchInput").val().toLowerCase().trim();
            if (!value) {
                renderTable();
                renderPagination();
                return;
            }

            filteredData = tableData.filter((row) =>
                Object.values(row).some((field) => {

                    const plainText = $('<div>').html(field === null || field === undefined ? "" : String(field)).text().toLowerCase().trim();
                    return plainText.includes(value);
                })
            );

            currentPage = 1;
            renderTable();
            renderPagination();
        };

        window.printTable = function () {
            const printWindow = window.open('', '', 'height=600,width=800');
            printWindow.document.write('<html><head><title>Print Table</title></head><body>');
            printWindow.document.write($("#leadsTable")[0].outerHTML);
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
        };

        window.exportToExcel = function () {
            const headers = [
                "S.No",
                "Student Name",
                "Mobile Number",
                "Email ID",
                "Business Task",
                "Category",
                "Domain",
                "Start Date",
                "End Date",
                "Connect Date",
                "Call Status",
                "Registration",
                "Selection Test",
                "WhatsApp Group",
                "Day1 Session Attendance",
                "Day1 Date",
                "Day1 Domain Task",
                "Day2 Session Attendance",
                "Day2 Date",
                "Day2 Domain Task",
                "Day3 Session Attendance",
                "Day3 Date",
                "Day3 Domain Task",
                "Day4 Session Attendance",
                "Day4 Date",
                "Day4 Domain Task",
                "Day5 Session Attendance",
                "Day5 Date",
                "Day5 Domain Task",
                "Day6 Session Attendance",
                "Day6 Date",
                "Day6 Domain Task",
                "Day7 Session Attendance",
                "Day7 Date",
                "Day7 Domain Task",
                "Module 2 Status",
                "TL Allocated"
            ];

            const data = [headers];

            tableData.forEach((row) => {
                const rowData = [
                    row.sno,
                    row.studentName,
                    row.mobileNumber,
                    row.emailId,
                    row.businessTask,
                    row.category,
                    row.domain,
                    formatDate(row.startDate),
                    formatDate(row.endDate),
                    formatDate(row.connectDate),
                    row.callStatus,
                    row.registration,
                    row.selectionTest,
                    row.whatsappGroup,
                    row.day1SessionAttendance,
                    formatDate(row.day1Date),
                    row.day1DomainTask,
                    row.day2SessionAttendance,
                    formatDate(row.day2Date),
                    row.day2DomainTask,
                    row.day3SessionAttendance,
                    formatDate(row.day3Date),
                    row.day3DomainTask,
                    row.day4SessionAttendance,
                    formatDate(row.day4Date),
                    row.day4DomainTask,
                    row.day5SessionAttendance,
                    formatDate(row.day5Date),
                    row.day5DomainTask,
                    row.day6SessionAttendance,
                    formatDate(row.day6Date),
                    row.day6DomainTask,
                    row.day7SessionAttendance,
                    formatDate(row.day7Date),
                    row.day7DomainTask,
                    row.module2Status,
                    row.tlAllocated
                ];

                data.push(rowData);
            });

            const worksheet = XLSX.utils.aoa_to_sheet(data);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "BDSheetData");
            XLSX.writeFile(workbook, "BDSheet_Data.xlsx");
        };

        $(document).ready(function () {
            loadTableData();
            setStickyColumns();
        });
    </script>

    <script>
        let analysisChart = null;

        function formatDateUI(dateStr) {
            const parts = dateStr.split("-");
            if (parts.length === 3) {
                return `${parts[2]}-${parts[1]}-${parts[0]}`;
            }
            return dateStr;
        }

        function formatDateWithDay(dateStr) {
            const date = new Date(dateStr);

            // Format date as dd/mm/yyyy
            const formattedDate = date.toLocaleDateString("en-GB", {
                day: "2-digit",
                month: "2-digit",
                year: "numeric",
            }).replace(/\//g, "-");

            // Get full day name
            const dayName = date.toLocaleDateString("en-GB", { weekday: "long" });

            return `${formattedDate} (${dayName})`;
        }

        // ---- Updated Dashboard Data Loader ----
        function loadDashboardData(startDate = null, endDate = null) {
            let url = `https://eduroom.in/api/v1/studentresume/work-analysis?teamManagerId=${teamManagerId}`;

            if (startDate && endDate) {
                url += `&fromDate=${startDate}&toDate=${endDate}`;
            }

            $.ajax({
                url: url,
                type: "GET",
                success: function (response) {
                    console.log("Dashboard summary response:", response);

                    if (response.success && response.data && response.data.length > 0) {
                        const totals = response.data[0];

                        // ---- College Count ----
                        $("#totalColleges").text(totals.collegesAchieved || 0);
                        $("#targetColleges").text(totals.collegeTarget || 0);

                        let collegesPercent = (totals.collegeTarget > 0)
                            ? ((totals.collegesAchieved / totals.collegeTarget) * 100).toFixed(1)
                            : 0;
                        $("#collegesPercent").text(collegesPercent + "%");

                        // ---- Resume Count ----
                        $("#totalResumes").text(totals.resumesAchieved || 0);
                        $("#targetResumes").text(totals.resumesReceivedTarget || 0);

                        let resumesPercent = (totals.resumesReceivedTarget > 0)
                            ? ((totals.resumesAchieved / totals.resumesReceivedTarget) * 100).toFixed(1)
                            : 0;
                        $("#resumesPercent").text(resumesPercent + "%");

                        // ---- Interviews Scheduled ----
                        $("#totalInterviews").text(totals.interviewsAchieved || 0);
                        $("#targetInterviews").text(totals.interviewsTarget || 0);

                        let interviewsPercent = (totals.interviewsTarget > 0)
                            ? ((totals.interviewsAchieved / totals.interviewsTarget) * 100).toFixed(1)
                            : 0;
                        $("#interviewsPercent").text(interviewsPercent + "%");

                        // ---- New: Resume Achieved (Card 1) ----
                        $("#totalResumes3").text(totals.resumesAchieved || 0);

                        // ---- New: Interviews Achieved (Card 2) ----
                        $("#totalInterviews3").text(totals.interviewsAchieved || 0);
                    }
                },
                error: function (err) {
                    console.error("Error fetching dashboard summary:", err);
                }
            });
        }

        // ---- Work Analysis Chart ----
        function loadAnalysisChart(startDate = null, endDate = null) {
            let url = `https://eduroom.in/api/v1/studentresume/work-analysis?teamManagerId=${teamManagerId}`;

            if (startDate && endDate) {
                url += `&fromDate=${startDate}&toDate=${endDate}`;
            }

            $.ajax({
                url: url,
                type: "GET",
                dataType: "json",
                success: function (res) {
                    console.log("Work Analysis Data:", res);
                    const jdList = $("#jdList");
                    jdList.empty();

                    if (res.success && res.data && res.data.length > 0) {
                        // ---- Aggregate by date ----
                        const dateMap = {}; // { "02 September 2025": { resumes: X, interviews: Y } }

                        res.data.forEach(person => {
                            // Count resumes
                            person.resumeDates.forEach(d => {
                                const cleanDate = d.split(", ")[1]; // e.g. "02 September 2025"
                                if (!dateMap[cleanDate]) dateMap[cleanDate] = { resumes: 0, interviews: 0 };
                                dateMap[cleanDate].resumes++;
                            });

                            // Count interviews
                            person.interviewDates.forEach(d => {
                                const cleanDate = d.split(", ")[1];
                                if (!dateMap[cleanDate]) dateMap[cleanDate] = { resumes: 0, interviews: 0 };
                                dateMap[cleanDate].interviews++;
                            });
                        });

                        // Convert map  arrays
                        const fullDates = Object.keys(dateMap); // full for jdList
                        const dates = fullDates.map(d => d.split(" ")[0]); // only day number for chart
                        const resumeCounts = fullDates.map(d => dateMap[d].resumes);
                        const interviewCounts = fullDates.map(d => dateMap[d].interviews);

                        // ---- Sync jdList (date + day in one row) ----
                        fullDates.forEach((d, idx) => {
                            const formattedWithDay = formatDateWithDay(d);
                            jdList.append(`
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <span>${formattedWithDay}</span>
                                <span class="fw-bold">Resumes: ${resumeCounts[idx]} | Regitrations Achieved: ${interviewCounts[idx]}</span>
                            </li>
                        `);
                        });

                        // ---- Update / Create Chart ----
                        if (analysisChart) {
                            analysisChart.updateOptions({
                                series: [
                                    { name: "Resumes Achieved", data: resumeCounts },
                                    { name: "Registrations Achieved", data: interviewCounts }
                                ],
                                xaxis: {
                                    categories: dates,
                                    labels: {
                                        show: true,
                                        style: { colors: "#fff", fontFamily: "Roboto" }
                                    },
                                    axisBorder: { show: false }
                                }
                            });
                        } else {
                            analysisChart = new ApexCharts(document.querySelector("#conversion-statistic-bar-chart"), {
                                series: [
                                    { name: "Resumes Achieved", data: resumeCounts },
                                    { name: "Registrations Achieved", data: interviewCounts }
                                ],
                                chart: { type: "bar", height: 200, toolbar: { show: false } },
                                plotOptions: { bar: { horizontal: false, endingShape: "rounded", columnWidth: "30%" } },
                                colors: ["#fff", "#ffb74d"],
                                grid: { show: false },
                                legend: { show: true },
                                dataLabels: { enabled: false },
                                xaxis: {
                                    categories: dates,
                                    labels: { show: true, style: { colors: "#fff", fontFamily: "Roboto" } },
                                    axisBorder: { show: false }
                                },
                                yaxis: { labels: { show: true, style: { colors: "#fff" } } },
                                tooltip: {
                                    theme: "dark",
                                    y: { formatter: (val, opts) => opts.seriesIndex === 0 ? val + " Resumes" : val + " Registrations" },
                                    style: { colors: "#000", fontFamily: "Roboto" }
                                }
                            });
                            analysisChart.render();
                        }
                    } else {
                        console.warn("No work analysis data found.");
                        jdList.append(`<li><span class="date">No Data</span><span class="count">0/0</span></li>`);
                        if (analysisChart) {
                            analysisChart.updateOptions({
                                series: [
                                    { name: "Resumes Achieved", data: [] },
                                    { name: "Registrations Achieved", data: [] }
                                ],
                                xaxis: { categories: [] }
                            });
                        }
                    }
                },
                error: function (err) {
                    console.error("Error fetching work analysis data", err);
                }
            });
        }

        let fromDate = null;
        let toDate = null;

        flatpickr("#dateRangePicker", {
            mode: "range",
            dateFormat: "Y-m-d",
            onClose: function (selectedDates, dateStr, instance) {
                if (selectedDates.length === 2) {
                    fromDate = instance.formatDate(selectedDates[0], "Y-m-d");
                    toDate = instance.formatDate(selectedDates[1], "Y-m-d");

                    console.log("From:", fromDate, "To:", toDate);

                    loadDashboardData(fromDate, toDate);
                    loadAnalysisChart(fromDate, toDate);
                }
            }
        });

        $(document).ready(function () {
            const today = new Date().toISOString().split("T")[0];
            loadDashboardData(today, today);
            loadAnalysisChart(today, today);
        });
    </script>

    <script>
        document.addEventListener("click", function (e) {
            if (e.target.closest(".delete-record")) {
                let button = e.target.closest(".delete-record");
                let recordId = button.getAttribute("data-id");

                Swal.fire({
                    title: "Are you sure?",
                    text: "This action cannot be undone!",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#d33",
                    cancelButtonColor: "#6c757d",
                    confirmButtonText: "Yes, delete it!"
                }).then((result) => {
                    if (result.isConfirmed) {
                        console.log("Deleting record with ID:", recordId);

                        $.ajax({
                            url: `https://eduroom.in/api/v1/studentresume/delete/${recordId}`,
                            method: "DELETE",
                            success: function (res) {
                                Swal.fire(
                                    "Deleted!",
                                    "The record has been deleted.",
                                    "success"
                                ).then(() => {
                                    $(button).closest("tr").remove();
                                });
                            },
                            error: function (err) {
                                console.error("Delete failed", err);
                                Swal.fire(
                                    "Error!",
                                    "Failed to delete the record.",
                                    "error"
                                );
                            }
                        });
                    }
                });
            }
        });
    </script>

    <script>
        window.addEventListener("pageshow", function (event) {
            if (event.persisted || (window.performance && window.performance.getEntriesByType("navigation")[0].type === "back_forward")) {
                window.location.reload();
            }
        });

        $(document).ready(function () {
            const userId = sessionStorage.getItem("user_id");

            if (!userId) {
                Swal.fire({
                    icon: "warning",
                    title: "Login Required",
                    text: "You must log in to access this page.",
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                    showConfirmButton: true,
                    confirmButtonText: "Go to Login"
                }).then(() => {
                    window.top.location.href = "/login.html";
                });
                return;
            }

            $(document).on("click", "#logoutBtn", function () {
                Swal.fire({
                    title: "Logging out...",
                    text: "Please wait",
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                $.ajax({
                    url: "https://eduroom.in/api/v1/user/logout",
                    type: "POST",
                    contentType: "application/json",
                    data: JSON.stringify({ id: userId }),
                    success: function (res) {
                        console.log("Logout success:", res);
                        sessionStorage.removeItem("user_id");
                        sessionStorage.removeItem("coursePasswordVerified");

                        Swal.fire({
                            icon: "success",
                            title: "Logged Out",
                            text: "You have been logged out successfully!",
                            showConfirmButton: false,
                            timer: 2000
                        }).then(() => {
                            window.top.location.href = "/login.html";
                        });
                    },
                    error: function (err) {
                        console.error("Logout error:", err);
                        Swal.fire({
                            icon: "error",
                            title: "Logout Failed",
                            text: "Something went wrong. Please try again!",
                            allowOutsideClick: false,
                            confirmButtonText: "OK"
                        });
                    }
                });
            });
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        fetch("/config.json")
            .then(response => response.json())
            .then(config => {
                const HARD_CODED_PASSWORD = config.HARD_CODED_PASSWORD || "";
                const SESSION_KEY = "coursePasswordVerified";

                const protectedLi = document.getElementById("protectedDropdown");
                const trigger = document.getElementById("protectedTrigger");
                const submenu = protectedLi.querySelector(".protected-submenu");

                function openProtectedMenu() {
                    protectedLi.classList.add("is-open");
                    submenu.style.display = "block";
                }

                function closeProtectedMenu() {
                    protectedLi.classList.remove("is-open");
                    submenu.style.display = "none";
                }

                if (sessionStorage.getItem(SESSION_KEY) === "true") {
                    openProtectedMenu();
                } else {
                    closeProtectedMenu();
                }

                trigger.addEventListener("click", function (ev) {
                    ev.preventDefault();
                    ev.stopPropagation();
                    ev.stopImmediatePropagation();

                    if (sessionStorage.getItem(SESSION_KEY) === "true") {
                        if (protectedLi.classList.contains("is-open")) {
                            closeProtectedMenu();
                        } else {
                            openProtectedMenu();
                        }
                        return;
                    }

                    Swal.fire({
                        title: "Enter Password",
                        input: "password",
                        inputPlaceholder: "Enter access password",
                        showCancelButton: true,
                        confirmButtonText: "Submit",
                        allowOutsideClick: false,
                        inputValidator: (value) => {
                            if (!value) return "Password cannot be empty!";
                            return null;
                        }
                    }).then((result) => {
                        if (result.isConfirmed) {
                            const userPassword = result.value;

                            if (userPassword === HARD_CODED_PASSWORD) {
                                sessionStorage.setItem(SESSION_KEY, "true");
                                Swal.fire({
                                    icon: "success",
                                    title: "Access Granted",
                                    timer: 1000,
                                    showConfirmButton: false
                                }).then(() => openProtectedMenu());
                            } else {
                                Swal.fire({
                                    icon: "error",
                                    title: "Invalid Password",
                                    text: "You are not allowed to access this section."
                                });
                                closeProtectedMenu();
                            }
                        } else {
                            closeProtectedMenu();
                        }
                    });
                });

                document.addEventListener("click", function (e) {
                    const inside = protectedLi.contains(e.target);
                    if (!inside && !sessionStorage.getItem(SESSION_KEY)) {
                        closeProtectedMenu();
                    }
                });

            })
            .catch(err => {
                console.error("Could not load config.json:", err);
            });
    </script>

    <style>
        #protectedDropdown.is-open>.protected-submenu {
            display: block !important;
        }
    </style>

</body>

</html>